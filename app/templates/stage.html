{% extends 'base.html' %}

{% import "csvtable-macros.html" as tbl with context %}
{% import "base-macros.html" as base with context %}

{% macro position (left, top, width, height) %}
style="left:{{ left }}; top:{{ top }}; width:{{ width }}; height:{{ height }};"
{% endmacro %}


{% block header %}
  <h2> {% block title %} Bühne {% endblock %} </h2>
{% endblock %}

{% block subtitle %}
  {{ base.subtitle_with_button (shortname, 
      svgid = "#svg-gear",
      endpoint = url_for ('data.dataedit_stage') )
  }}
{% endblock %}

{% block css %}
<style>
</style>
{% endblock %}

{% block content %}
<!-- neue Zeile: Formular -->
<div class="row">
  <div class="col" id="links"></div>
  <div class="col" id="rechts"></div>
</div>  

<!-- Button für modaldialogToPython -->
<div id="showModal"></div>

<div id="stagewrapper" class="stage-wrapper">
  {{ tbl.stage_nav () }}

  <!-- <div id="canvas" class="stage-canvas"> -->

    <div id="csvtable" class=" bg-light stage" 
        file="{{ file }}" pluspath="{{ pluspath }}" changes="{{ changes }}">
<!-- ui-widget-content -->
      {% for item in items %}
      <div class="stage-element {{ item.Type.lower() }}" 
        row_num="{{ loop.index }}"
        {{ position (left=item.Left,   top=item.Top, 
                    width=item.Width, height=item.Height ) }} >
        {% if item.Type == "Head" %}
          <div class="intensity-container">
            <div class="intensity-indicator head-{{ item.Name }}"></div>
          </div>
          <div class="color-indicator"></div>
        {% endif %}
        <div class="itemName edit_div text-wrap">{{ item.Name }}</div>
        <div class="itemText edit_div text-wrap">{{ item.Text }}</div>
        <div class="itemComment edit_div text-wrap">{{ item.Comment }}</div>
      </div>
      {% endfor %}
    </div> 

  <!-- </div> canvas -->
</div>
{% endblock %}

{% block javascript %}
  <script src="/static/js/stage.js"></script>
  <script>
    function initMouseMode () {
      // wird in der jeweiligen html-Seite neu definiert
      initStageMouse ();
    };
   
    $(document).ready ( function () {  
      initStageMouse ();
      // selectableStageElements ();
      periodic_attribstatus ();
      csvSavediscardButtons ();
    });  

  </script>
{% endblock %}

